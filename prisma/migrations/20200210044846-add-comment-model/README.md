# Migration `20200210044846-add-comment-model`

This migration has been generated by fastspeeed at 2/10/2020, 4:48:46 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
PRAGMA foreign_keys=OFF;

CREATE TABLE "quaint"."new_Province" (
    "country" TEXT NOT NULL  ,
    "id" TEXT NOT NULL  ,
    "title" TEXT NOT NULL DEFAULT '' ,
    PRIMARY KEY ("id"),FOREIGN KEY ("country") REFERENCES "Country"("id") ON DELETE RESTRICT
) 

INSERT INTO "new_Province" ("country","id","title") SELECT "country","id","title" from "Province"

DROP TABLE "quaint"."Province";

ALTER TABLE "quaint"."new_Province" RENAME TO "Province";

CREATE UNIQUE INDEX "quaint"."Province.title" ON "Province"("title")

PRAGMA "quaint".foreign_key_check;

PRAGMA foreign_keys=ON;

PRAGMA foreign_keys=OFF;

CREATE TABLE "quaint"."new_City" (
    "id" TEXT NOT NULL  ,
    "province" TEXT NOT NULL  ,
    "title" TEXT NOT NULL DEFAULT '' ,
    PRIMARY KEY ("id"),FOREIGN KEY ("province") REFERENCES "Province"("id") ON DELETE RESTRICT
) 

INSERT INTO "new_City" ("id","province","title") SELECT "id","province","title" from "City"

DROP TABLE "quaint"."City";

ALTER TABLE "quaint"."new_City" RENAME TO "City";

PRAGMA "quaint".foreign_key_check;

PRAGMA foreign_keys=ON;

PRAGMA foreign_keys=OFF;

CREATE TABLE "quaint"."new_Country" (
    "continents" TEXT   ,
    "id" TEXT NOT NULL  ,
    "title" TEXT NOT NULL DEFAULT '' ,
    PRIMARY KEY ("id")
) 

INSERT INTO "new_Country" ("continents","id","title") SELECT "continents","id","title" from "Country"

DROP TABLE "quaint"."Country";

ALTER TABLE "quaint"."new_Country" RENAME TO "Country";

CREATE UNIQUE INDEX "quaint"."Country.title" ON "Country"("title")

PRAGMA "quaint".foreign_key_check;

PRAGMA foreign_keys=ON;

PRAGMA foreign_keys=OFF;

CREATE TABLE "quaint"."new_CountryRecord" (
    "confirmedAddCount" INTEGER   ,
    "confirmedCount" INTEGER NOT NULL DEFAULT 0 ,
    "continents" TEXT   ,
    "country" TEXT NOT NULL  ,
    "createdAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "curedAddCount" INTEGER   ,
    "curedCount" INTEGER NOT NULL DEFAULT 0 ,
    "deadAddCount" INTEGER   ,
    "deadCount" INTEGER NOT NULL DEFAULT 0 ,
    "id" TEXT NOT NULL  ,
    "recordAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "seriousAddCount" INTEGER   ,
    "seriousCount" INTEGER   ,
    "sourceUrl" TEXT NOT NULL DEFAULT '' ,
    "suspectedAddCount" INTEGER   ,
    "suspectedCount" INTEGER NOT NULL DEFAULT 0 ,
    "updatedAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "virus" TEXT NOT NULL  ,
    PRIMARY KEY ("id"),FOREIGN KEY ("country") REFERENCES "Country"("id") ON DELETE RESTRICT,
FOREIGN KEY ("virus") REFERENCES "VirusInfo"("id") ON DELETE RESTRICT
) 

INSERT INTO "new_CountryRecord" ("confirmedAddCount","confirmedCount","continents","country","createdAt","curedAddCount","curedCount","deadAddCount","deadCount","id","recordAt","seriousAddCount","seriousCount","sourceUrl","suspectedAddCount","suspectedCount","updatedAt","virus") SELECT "confirmedAddCount","confirmedCount","continents","country","createdAt","curedAddCount","curedCount","deadAddCount","deadCount","id","recordAt","seriousAddCount","seriousCount","sourceUrl","suspectedAddCount","suspectedCount","updatedAt","virus" from "CountryRecord"

DROP TABLE "quaint"."CountryRecord";

ALTER TABLE "quaint"."new_CountryRecord" RENAME TO "CountryRecord";

PRAGMA "quaint".foreign_key_check;

PRAGMA foreign_keys=ON;

PRAGMA foreign_keys=OFF;

CREATE TABLE "quaint"."new_ProvinceRecord" (
    "confirmedCount" INTEGER NOT NULL DEFAULT 0 ,
    "country" TEXT NOT NULL  ,
    "createdAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "curedCount" INTEGER NOT NULL DEFAULT 0 ,
    "deadCount" INTEGER NOT NULL DEFAULT 0 ,
    "id" TEXT NOT NULL  ,
    "province" TEXT NOT NULL  ,
    "recordAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "sourceUrl" TEXT NOT NULL DEFAULT '' ,
    "suspectedCount" INTEGER NOT NULL DEFAULT 0 ,
    "updatedAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "virus" TEXT NOT NULL  ,
    PRIMARY KEY ("id"),FOREIGN KEY ("country") REFERENCES "Country"("id") ON DELETE RESTRICT,
FOREIGN KEY ("province") REFERENCES "Province"("id") ON DELETE RESTRICT,
FOREIGN KEY ("virus") REFERENCES "VirusInfo"("id") ON DELETE RESTRICT
) 

INSERT INTO "new_ProvinceRecord" ("confirmedCount","country","createdAt","curedCount","deadCount","id","province","recordAt","sourceUrl","suspectedCount","updatedAt","virus") SELECT "confirmedCount","country","createdAt","curedCount","deadCount","id","province","recordAt","sourceUrl","suspectedCount","updatedAt","virus" from "ProvinceRecord"

DROP TABLE "quaint"."ProvinceRecord";

ALTER TABLE "quaint"."new_ProvinceRecord" RENAME TO "ProvinceRecord";

PRAGMA "quaint".foreign_key_check;

PRAGMA foreign_keys=ON;

PRAGMA foreign_keys=OFF;

CREATE TABLE "quaint"."new_CityRecord" (
    "city" TEXT NOT NULL  ,
    "confirmedCount" INTEGER NOT NULL DEFAULT 0 ,
    "country" TEXT NOT NULL  ,
    "createdAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "curedCount" INTEGER NOT NULL DEFAULT 0 ,
    "deadCount" INTEGER NOT NULL DEFAULT 0 ,
    "id" TEXT NOT NULL  ,
    "province" TEXT NOT NULL  ,
    "recordAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "sourceUrl" TEXT NOT NULL DEFAULT '' ,
    "suspectedCount" INTEGER NOT NULL DEFAULT 0 ,
    "updatedAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "virus" TEXT NOT NULL  ,
    PRIMARY KEY ("id"),FOREIGN KEY ("country") REFERENCES "Country"("id") ON DELETE RESTRICT,
FOREIGN KEY ("province") REFERENCES "Province"("id") ON DELETE RESTRICT,
FOREIGN KEY ("city") REFERENCES "City"("id") ON DELETE RESTRICT,
FOREIGN KEY ("virus") REFERENCES "VirusInfo"("id") ON DELETE RESTRICT
) 

INSERT INTO "new_CityRecord" ("city","confirmedCount","country","createdAt","curedCount","deadCount","id","province","recordAt","sourceUrl","suspectedCount","updatedAt","virus") SELECT "city","confirmedCount","country","createdAt","curedCount","deadCount","id","province","recordAt","sourceUrl","suspectedCount","updatedAt","virus" from "CityRecord"

DROP TABLE "quaint"."CityRecord";

ALTER TABLE "quaint"."new_CityRecord" RENAME TO "CityRecord";

PRAGMA "quaint".foreign_key_check;

PRAGMA foreign_keys=ON;
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200210034724-add-comment-model..20200210044846-add-comment-model
--- datamodel.dml
+++ datamodel.dml
@@ -1,157 +1,117 @@
+datasource db {
+  provider = "sqlite"
+  url      = "file:new.db"
+  default  = true
+}
+
 generator client {
   provider = "prisma-client-js"
 }
-datasource db {
-  provider = "sqlite"
-  url = "***"
+enum Role {
+  USER
+  VERIFIED
+  ADMIN
 }
 model User {
-  avatar    Boolean  @default(false)
-  createdAt DateTime
-  email     String   @default("") @unique
-  id        String   @id
-  name      String?  @unique
-  nickname  String   @default("") @unique
-  password  String   @default("")
-  role      String   @default("USER")
-  updatedAt DateTime
+  id                  String        @default(cuid()) @id
+  email               String        @unique
+  name                String?       @unique
+  nickname            String        @unique
+  password            String
+  avatar              Boolean       @default(false)
+  role                Role          @default(USER)
+  createdAt           DateTime      @default(now())
+  updatedAt           DateTime      @updatedAt
 }
+model Country {
+  id       String     @default(cuid()) @id
+  title    String     @unique
+  continents String?
+  provinces Province[]
+}
+
 model Province {
-  id              String           @id
-  title           String           @default("") @unique
-  country         Country
-  cities          City[]
-  provinceRecords ProvinceRecord[] @relation(references: [province])
-  cityRecords     CityRecord[]
-
-  suspectedCount Int @default(0)
-  curedCount Int @default(0)
-  deadCount Int @default(0)
-  confirmedCount Int @default(0)
-  suspectedCountY Int @default(0)
-  curedCountY Int @default(0)
-  deadCountY Int @default(0)
-  confirmedCountY Int @default(0)
-  recordAt          DateTime
+  id      String  @default(cuid()) @id
+  title   String  @unique
+  country Country
+  cities  City[]
 }
 model City {
-  id          String       @id
-  title       String       @default("")
-  province    Province
-  areas       Area[]
-  cityRecords CityRecord[] @relation(references: [city])
-
-  suspectedCount Int @default(0)
-  curedCount Int @default(0)
-  deadCount Int @default(0)
-  confirmedCount Int @default(0)
-  suspectedCountY Int @default(0)
-  curedCountY Int @default(0)
-  deadCountY Int @default(0)
-  confirmedCountY Int @default(0)
-  recordAt          DateTime
+  id       String   @default(cuid()) @id
+  title    String   
+  province Province
+  areas  Area[]
 }
 model Area {
-  id    String @id
-  title String @default("")
+  id    String @default(cuid()) @id
+  title String 
   city  City
 }
 model VirusInfo {
-  description     String           @default("")
-  id              String           @id
-  title           String           @default("") @unique
-  countryRecords  CountryRecord[]
-  provinceRecords ProvinceRecord[]
-  cityRecords     CityRecord[]
+  id          String @default(cuid()) @id
+  title       String @unique
+  description String
 }
-
-model Country {
-  continents      String?
-  id              String           @id
-  title           String           @default("") @unique
-  provinces       Province[]       @relation(references: [country])
-  countryRecords  CountryRecord[]  @relation(references: [country])
-  provinceRecords ProvinceRecord[] @relation(references: [country])
-  cityRecords     CityRecord[]
-  suspectedCount Int @default(0)
-  curedCount Int @default(0)
-  deadCount Int @default(0)
-  confirmedCount Int @default(0)
-  suspectedCountY Int @default(0)
-  curedCountY Int @default(0)
-  deadCountY Int @default(0)
-  confirmedCountY Int @default(0)
-  recordAt          DateTime
-}
-
 model CountryRecord {
+  id             String    @default(cuid()) @id
+  country        Country
+  continents String?
+  virus          VirusInfo
+  sourceUrl      String
+  suspectedCount Int
+  confirmedCount Int
+  curedCount     Int
+  deadCount      Int
+  seriousCount   Int?
+  suspectedAddCount Int?
   confirmedAddCount Int?
-  confirmedCount    Int       @default(0)
-  continents        String?
-  createdAt         DateTime
   curedAddCount     Int?
-  curedCount        Int       @default(0)
   deadAddCount      Int?
-  deadCount         Int       @default(0)
-  id                String    @id
-  recordAt          DateTime
   seriousAddCount   Int?
-  seriousCount      Int?
-  sourceUrl         String    @default("")
-  suspectedAddCount Int?
-  suspectedCount    Int       @default(0)
-  updatedAt         DateTime
-  country           Country
-  virus             VirusInfo
+  recordAt       DateTime  
+  createdAt      DateTime  @default(now())
+  updatedAt      DateTime  @updatedAt
-  suspectedCountY Int @default(0)
-  curedCountY Int @default(0)
-  deadCountY Int @default(0)
-  confirmedCountY Int @default(0)
 }
 model ProvinceRecord {
-  confirmedCount Int       @default(0)
-  createdAt      DateTime
-  curedCount     Int       @default(0)
-  deadCount      Int       @default(0)
-  id             String    @id
-  recordAt       DateTime
-  sourceUrl      String    @default("")
-  suspectedCount Int       @default(0)
-  updatedAt      DateTime
+  id             String    @default(cuid()) @id
   country        Country
   province       Province
   virus          VirusInfo
+  sourceUrl      String
+  suspectedCount Int
+  confirmedCount Int
+  curedCount     Int
+  deadCount      Int
-  suspectedCountY Int @default(0)
-  curedCountY Int @default(0)
-  deadCountY Int @default(0)
-  confirmedCountY Int @default(0)
+  recordAt       DateTime  
+  createdAt      DateTime  @default(now())
+  updatedAt      DateTime  @updatedAt
+
+
 }
 model CityRecord {
-  confirmedCount Int       @default(0)
-  createdAt      DateTime
-  curedCount     Int       @default(0)
-  deadCount      Int       @default(0)
-  id             String    @id
-  recordAt       DateTime
-  sourceUrl      String    @default("")
-  suspectedCount Int       @default(0)
-  updatedAt      DateTime
-  city           City
+  id             String    @default(cuid()) @id
   country        Country
   province       Province
+  city           City
   virus          VirusInfo
-  suspectedCountY Int @default(0)
-  curedCountY Int @default(0)
-  deadCountY Int @default(0)
-  confirmedCountY Int @default(0)
+  sourceUrl      String
+  suspectedCount Int
+  confirmedCount Int
+  curedCount     Int
+  deadCount      Int
+  recordAt       DateTime  
+  createdAt      DateTime  @default(now())
+  updatedAt      DateTime  @updatedAt
+
+ 
 }
```


