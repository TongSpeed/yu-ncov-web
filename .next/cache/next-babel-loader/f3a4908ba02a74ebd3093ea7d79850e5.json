{"ast":null,"code":"import _Object$defineProperty from \"@babel/runtime-corejs2/core-js/object/define-property\";\nimport _Object$defineProperties from \"@babel/runtime-corejs2/core-js/object/define-properties\";\nimport _Object$getOwnPropertyDescriptors from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptors\";\nimport _Object$getOwnPropertyDescriptor from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptor\";\nimport _Object$getOwnPropertySymbols from \"@babel/runtime-corejs2/core-js/object/get-own-property-symbols\";\nimport _Object$keys from \"@babel/runtime-corejs2/core-js/object/keys\";\nimport _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = _Object$keys(object); if (_Object$getOwnPropertySymbols) { var symbols = _Object$getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return _Object$getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (_Object$getOwnPropertyDescriptors) { _Object$defineProperties(target, _Object$getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { _Object$defineProperty(target, key, _Object$getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React from 'react';\nimport App from 'next/app';\nimport Root from '../src/app/App';\nimport { AppProvider } from '../src/app/AppContext';\nimport Head from 'next/head';\nimport { ApolloProvider } from '@apollo/react-hooks';\nimport { ApolloClient } from 'apollo-client';\nimport { InMemoryCache } from 'apollo-cache-inmemory';\nimport { HttpLink } from 'apollo-link-http';\nimport appOption from '../data';\nimport fetch from 'isomorphic-unfetch';\nexport var apolloClient = null;\nexport var initApolloClient = function initApolloClient() {\n  var initialState = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  console.log(process.env.GRAPHQL_URL);\n  var link = new HttpLink({\n    uri: \"http://localhost:3000/api/graphql\",\n    credentials: 'same-origin',\n    fetch: fetch\n  });\n\n  var createApolloClient = function createApolloClient() {\n    var initialState = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    return new ApolloClient({\n      ssrMode: false,\n      link: link,\n      cache: new InMemoryCache().restore(initialState)\n    });\n  };\n\n  if (false) {\n    return createApolloClient(initialState);\n  }\n\n  if (!apolloClient) {\n    apolloClient = createApolloClient(initialState);\n  }\n\n  return apolloClient;\n};\n\nvar MyApp =\n/*#__PURE__*/\nfunction (_App) {\n  _inherits(MyApp, _App);\n\n  function MyApp() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, MyApp);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(MyApp)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"client\", apolloClient || initApolloClient(_this.props.apolloState));\n\n    return _this;\n  }\n\n  _createClass(MyApp, [{\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          Component = _this$props.Component,\n          pageProps = _this$props.pageProps;\n      return __jsx(ApolloProvider, {\n        client: this.client\n      }, __jsx(AppProvider, {\n        data: appOption\n      }, __jsx(Root, null, __jsx(Component, pageProps))));\n    }\n  }]);\n\n  return MyApp;\n}(App);\n\nexport { MyApp as default };\n\nMyApp.getInitialProps = function _callee(_ref) {\n  var ctx, AppTree, pageProps, _ref2, getDataFromTree, apolloState;\n\n  return _regeneratorRuntime.async(function _callee$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          ctx = _ref.ctx;\n          AppTree = ctx.AppTree;\n          apolloClient = initApolloClient();\n          pageProps = {};\n\n          if (!false) {\n            _context.next = 18;\n            break;\n          }\n\n          _context.prev = 5;\n          _context.next = 8;\n          return _regeneratorRuntime.awrap(import('@apollo/react-ssr'));\n\n        case 8:\n          _ref2 = _context.sent;\n          getDataFromTree = _ref2.getDataFromTree;\n          _context.next = 12;\n          return _regeneratorRuntime.awrap(getDataFromTree(__jsx(AppTree, {\n            pageProps: _objectSpread({}, pageProps)\n          })));\n\n        case 12:\n          _context.next = 17;\n          break;\n\n        case 14:\n          _context.prev = 14;\n          _context.t0 = _context[\"catch\"](5);\n          console.error('Error while running `getDataFromTree`', _context.t0);\n\n        case 17:\n          Head.rewind();\n\n        case 18:\n          apolloState = apolloClient.cache.extract();\n          return _context.abrupt(\"return\", {\n            pageProps: pageProps,\n            apolloState: apolloState\n          });\n\n        case 20:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, null, null, [[5, 14]]);\n};","map":null,"metadata":{},"sourceType":"module"}